# æœ€ç»ˆç¼–è¯‘æŒ‡å— - æ‰€æœ‰é—®é¢˜å·²è§£å†³ âœ…

## ğŸ‰ é—®é¢˜å·²å…¨éƒ¨ä¿®å¤

ç»è¿‡å¤šæ¬¡è¿­ä»£ï¼Œä»¥ä¸‹æ‰€æœ‰ç¼–è¯‘é—®é¢˜å·²æˆåŠŸè§£å†³ï¼š

### âœ… å·²ä¿®å¤çš„é—®é¢˜åˆ—è¡¨

1. **dmg-license æ¨¡å—ç¼ºå¤±** - âœ… é€šè¿‡ GitHub Actions åœ¨çœŸå® macOS ä¸Šç¼–è¯‘
2. **GitHub Actions v3 å¼ƒç”¨** - âœ… å‡çº§åˆ° v4
3. **TypeScript æ¨¡å—é…ç½®é”™è¯¯** - âœ… æ”¹ä¸º CommonJS
4. **Windows better-sqlite3 ç¼–è¯‘å¤±è´¥** - âœ… é…ç½® asarUnpack å’Œ .npmrc
5. **PostCSS é…ç½®è¯­æ³•é”™è¯¯** - âœ… æ”¹ä¸º CommonJS è¯­æ³•
6. **Tailwind é…ç½®è¯­æ³•é”™è¯¯** - âœ… æ”¹ä¸º CommonJS è¯­æ³•
7. **TypeScript é¡¹ç›®å¼•ç”¨å¯¼è‡´ main.js æœªç”Ÿæˆ** - âœ… ç§»é™¤é¡¹ç›®å¼•ç”¨é…ç½®
8. **Windows node-gyp ç¼–è¯‘å¡æ­»** - âœ… å¼ºåˆ¶ä½¿ç”¨é¢„æ„å»ºäºŒè¿›åˆ¶ï¼Œç¦ç”¨ node-gyp

---

## ğŸ“¦ æ–¹æ³•ä¸€ï¼šä½¿ç”¨ GitHub Actionsï¼ˆæ¨èï¼‰

è¿™æ˜¯**æœ€å¯é **çš„è·¨å¹³å°ç¼–è¯‘æ–¹æ¡ˆï¼Œèƒ½åŒæ—¶ç”Ÿæˆ Windowsã€macOS å’Œ Linux ä¸‰ä¸ªå¹³å°çš„å®‰è£…åŒ…ã€‚

### å‰ææ¡ä»¶

1. å°†ä»£ç æ¨é€åˆ° GitHub ä»“åº“
2. ç¡®ä¿ `.github/workflows/build.yml` å·²å­˜åœ¨

### æ“ä½œæ­¥éª¤

#### 1. æ¨é€ä»£ç åˆ° GitHub

```bash
# åˆå§‹åŒ– Git ä»“åº“ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
git init

# æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# æäº¤æ›´æ”¹
git commit -m "ä¿®å¤æ‰€æœ‰ç¼–è¯‘é—®é¢˜ï¼Œå‡†å¤‡å‘å¸ƒ v1.0.3"

# æ·»åŠ è¿œç¨‹ä»“åº“ï¼ˆæ›¿æ¢æˆä½ çš„ä»“åº“åœ°å€ï¼‰
git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/server-manager.git

# æ¨é€åˆ° GitHub
git push -u origin main
```

#### 2. åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾è§¦å‘ç¼–è¯‘

```bash
# åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag v1.0.3

# æ¨é€æ ‡ç­¾åˆ° GitHub
git push origin v1.0.3
```

#### 3. æŸ¥çœ‹ç¼–è¯‘è¿›åº¦

1. è®¿é—®ä½ çš„ GitHub ä»“åº“
2. ç‚¹å‡»é¡¶éƒ¨çš„ **"Actions"** æ ‡ç­¾
3. æŸ¥çœ‹ **"Build All Platforms"** å·¥ä½œæµçš„è¿è¡ŒçŠ¶æ€

#### 4. ä¸‹è½½ç¼–è¯‘ç»“æœ

ç¼–è¯‘å®Œæˆåï¼ˆå¤§çº¦ 10-15 åˆ†é’Ÿï¼‰ï¼š

1. åœ¨ Actions é¡µé¢ç‚¹å‡»æˆåŠŸçš„å·¥ä½œæµè¿è¡Œ
2. æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨çš„ **"Artifacts"** éƒ¨åˆ†
3. ä¸‹è½½å¯¹åº”å¹³å°çš„å®‰è£…åŒ…ï¼š
   - `windows-build` - Windows å®‰è£…ç¨‹åºï¼ˆ.exeï¼‰
   - `macos-build` - macOS åº”ç”¨ï¼ˆ.dmg, .appï¼‰
   - `linux-build` - Linux å®‰è£…åŒ…ï¼ˆ.AppImage, .debï¼‰

### æ‰‹åŠ¨è§¦å‘ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰

å¦‚æœä¸æƒ³åˆ›å»ºæ ‡ç­¾ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨è§¦å‘ï¼š

1. è¿›å…¥ GitHub ä»“åº“çš„ **Actions** é¡µé¢
2. é€‰æ‹© **"Build All Platforms"** å·¥ä½œæµ
3. ç‚¹å‡» **"Run workflow"** ä¸‹æ‹‰èœå•
4. ç‚¹å‡»ç»¿è‰²çš„ **"Run workflow"** æŒ‰é’®

---

## ğŸ’» æ–¹æ³•äºŒï¼šæœ¬åœ°ç¼–è¯‘ï¼ˆå•å¹³å°ï¼‰

å¦‚æœåªéœ€è¦ç¼–è¯‘å½“å‰å¹³å°çš„ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨æœ¬åœ°è¿›è¡Œã€‚

### å‰ææ¡ä»¶

- Node.js 18+
- npm æˆ– yarn
- å·²æ‰§è¡Œ `npm install`

### ç¼–è¯‘æ­¥éª¤

```bash
# 1. æ¸…ç†æ—§æ–‡ä»¶
rm -rf dist dist-electron release

# 2. æ„å»ºä»£ç 
npm run build

# 3. æ‰“åŒ…åº”ç”¨
npm run package
```

### è¾“å‡ºç»“æœ

ç¼–è¯‘å®Œæˆåï¼Œå®‰è£…åŒ…ä½äº `release/` ç›®å½•ï¼š

- **Windows**: `release/*.exe`ï¼ˆå®‰è£…ç‰ˆï¼‰ã€`release/*.portable.exe`ï¼ˆä¾¿æºç‰ˆï¼‰
- **macOS**: `release/*.dmg`ï¼ˆç£ç›˜é•œåƒï¼‰ã€`release/mac/`ï¼ˆåº”ç”¨åŒ…ï¼‰
- **Linux**: `release/*.AppImage`ï¼ˆé€šç”¨æ ¼å¼ï¼‰ã€`release/*.deb`ï¼ˆDebian/Ubuntuï¼‰

---

## ğŸ” éªŒè¯æ„å»ºç»“æœ

### æ£€æŸ¥æ„å»ºè¾“å‡º

```bash
# æ£€æŸ¥å‰ç«¯æ„å»º
ls -lh dist/

# æ£€æŸ¥ Electron ä¸»è¿›ç¨‹
ls -lh dist-electron/

# åº”è¯¥çœ‹åˆ°ï¼š
# dist/index.html
# dist/assets/
# dist-electron/main.js
# dist-electron/preload.js
# dist-electron/database.js
```

### æµ‹è¯•åº”ç”¨

```bash
# å¼€å‘æ¨¡å¼è¿è¡Œ
npm run dev

# æµ‹è¯•æ‰“åŒ…åçš„åº”ç”¨
# Windows: è¿è¡Œ release/*.exe
# macOS: æ‰“å¼€ release/*.dmg å¹¶å®‰è£…
# Linux: è¿è¡Œ release/*.AppImage
```

---

## ğŸ“‹ å…³é”®ä¿®å¤æ€»ç»“

### 1. TypeScript é…ç½®ä¿®å¤

**tsconfig.json**:
- âŒ ç§»é™¤äº† `"references": [{ "path": "./tsconfig.node.json" }]`

**tsconfig.node.json**:
- âŒ ç§»é™¤äº† `"composite": true`
- âœ… ä½¿ç”¨ `"module": "CommonJS"`
- âœ… ä½¿ç”¨ `"moduleResolution": "node"`

### 2. Package.json é…ç½®

```json
{
  // âŒ ç§»é™¤äº† "type": "module"
  "build": {
    "asarUnpack": [
      "node_modules/better-sqlite3/**/*"  // âœ… è§£åŒ…åŸç”Ÿæ¨¡å—
    ]
  },
  "scripts": {
    "postinstall": "electron-builder install-app-deps"  // âœ… è‡ªåŠ¨å®‰è£…ä¾èµ–
  }
}
```

### 3. é…ç½®æ–‡ä»¶è¯­æ³•ç»Ÿä¸€

æ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½ä½¿ç”¨ CommonJS è¯­æ³•ï¼š
- âœ… `postcss.config.js` - `module.exports = { ... }`
- âœ… `tailwind.config.js` - `module.exports = { ... }`

### 4. GitHub Actions ä¼˜åŒ–

- âœ… å‡çº§åˆ° actions/checkout@v4
- âœ… å‡çº§åˆ° actions/setup-node@v4
- âœ… å‡çº§åˆ° actions/upload-artifact@v4
- âœ… æ·»åŠ æ„å»ºéªŒè¯æ­¥éª¤
- âœ… é…ç½® Windows æ„å»ºå·¥å…·

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆæ¨èæµç¨‹ï¼‰

å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡ç¼–è¯‘ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

```bash
# 1. ç¡®ä¿ä¾èµ–å·²å®‰è£…
npm install

# 2. æµ‹è¯•å¼€å‘æ¨¡å¼
npm run dev

# 3. æµ‹è¯•æ„å»º
npm run build

# 4. æ¨é€åˆ° GitHub
git add .
git commit -m "å‡†å¤‡å‘å¸ƒ"
git push origin main

# 5. åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾è§¦å‘è‡ªåŠ¨ç¼–è¯‘
git tag v1.0.3
git push origin v1.0.3

# 6. ç­‰å¾… 10-15 åˆ†é’Ÿåï¼Œä» GitHub Actions ä¸‹è½½å®‰è£…åŒ…
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šnpm run build å¤±è´¥

```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install
npm run build
```

### é—®é¢˜ï¼šelectron-builder å¤±è´¥

```bash
# é‡æ–°æ„å»ºåŸç”Ÿæ¨¡å—
npm run rebuild
npm run package
```

### é—®é¢˜ï¼šGitHub Actions å¤±è´¥

1. æ£€æŸ¥ Actions æ—¥å¿—ä¸­çš„å…·ä½“é”™è¯¯
2. ç¡®è®¤æ‰€æœ‰é…ç½®æ–‡ä»¶å·²æ­£ç¡®æäº¤
3. éªŒè¯ package.json ä¸­çš„ author å’Œ homepage å­—æ®µ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `BUILD-AND-PACKAGE-GUIDE.md` - å®Œæ•´æ‰“åŒ…æŒ‡å—
- `GitHub-Actions-ç¼–è¯‘æŒ‡å—.md` - GitHub Actions è¯¦ç»†è¯´æ˜
- `TypeScript-é¡¹ç›®å¼•ç”¨é—®é¢˜ä¿®å¤.md` - TypeScript é…ç½®è¯´æ˜
- `Windows-better-sqlite3-ä¿®å¤è¯´æ˜.md` - Windows åŸç”Ÿæ¨¡å—é—®é¢˜
- `æ‰€æœ‰ç¼–è¯‘é—®é¢˜æœ€ç»ˆä¿®å¤æ€»ç»“.md` - æ‰€æœ‰é—®é¢˜çš„å®Œæ•´è®°å½•

---

## âœ¨ æˆåŠŸæ ‡å¿—

å½“ä½ çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¯´æ˜ç¼–è¯‘æˆåŠŸï¼š

```
âœ“ 1589 modules transformed.
dist/index.html                   0.72 kB â”‚ gzip:  0.40 kB
dist/assets/index-D3phULsD.css   18.58 kB â”‚ gzip:  4.12 kB
dist/assets/index-Cr5sYmGG.js   189.61 kB â”‚ gzip: 59.69 kB
âœ“ built in 3.91s
```

å¹¶ä¸”åœ¨ `dist-electron/` ç›®å½•ä¸­çœ‹åˆ°ï¼š
- âœ… `main.js` (11KB)
- âœ… `preload.js` (1.7KB)
- âœ… `database.js` (11KB)

**æ­å–œï¼ä½ çš„åº”ç”¨å·²ç»å¯ä»¥æˆåŠŸç¼–è¯‘äº†ï¼** ğŸŠ
